const Ee=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};Ee();function $(){}function xe(t,e){for(const r in e)t[r]=e[r];return t}function ve(t){return t()}function ce(){return Object.create(null)}function q(t){t.forEach(ve)}function Pe(t){return typeof t=="function"}function U(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let M;function K(t,e){return M||(M=document.createElement("a")),M.href=e,t===M.href}function Le(t){return Object.keys(t).length===0}function se(t,e,r,n){if(t){const o=be(t,e,r,n);return t[0](o)}}function be(t,e,r,n){return t[1]&&n?xe(r.ctx.slice(),t[1](n(e))):r.ctx}function le(t,e,r,n){if(t[2]&&n){const o=t[2](n(r));if(e.dirty===void 0)return o;if(typeof o=="object"){const i=[],c=Math.max(e.dirty.length,o.length);for(let a=0;a<c;a+=1)i[a]=e.dirty[a]|o[a];return i}return e.dirty|o}return e.dirty}function ae(t,e,r,n,o,i){if(o){const c=be(e,r,n,i);t.p(c,o)}}function ue(t){if(t.ctx.length>32){const e=[],r=t.ctx.length/32;for(let n=0;n<r;n++)e[n]=-1;return e}return-1}function h(t,e){t.appendChild(e)}function E(t,e,r){t.insertBefore(e,r||null)}function k(t){t.parentNode.removeChild(t)}function y(t){return document.createElement(t)}function W(t){return document.createTextNode(t)}function P(){return W(" ")}function X(){return W("")}function V(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function d(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function Ce(t){return Array.from(t.childNodes)}function $e(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Se(t,e,{bubbles:r=!1,cancelable:n=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,r,n,e),o}let O;function D(t){O=t}function je(){if(!O)throw new Error("Function called outside component initialization");return O}function we(){const t=je();return(e,r,{cancelable:n=!1}={})=>{const o=t.$$.callbacks[e];if(o){const i=Se(e,r,{cancelable:n});return o.slice().forEach(c=>{c.call(t,i)}),!i.defaultPrevented}return!0}}const T=[],Y=[],G=[],fe=[],Ae=Promise.resolve();let Z=!1;function Ne(){Z||(Z=!0,Ae.then(ye))}function ee(t){G.push(t)}const Q=new Set;let R=0;function ye(){const t=O;do{for(;R<T.length;){const e=T[R];R++,D(e),qe(e.$$)}for(D(null),T.length=0,R=0;Y.length;)Y.pop()();for(let e=0;e<G.length;e+=1){const r=G[e];Q.has(r)||(Q.add(r),r())}G.length=0}while(T.length);for(;fe.length;)fe.pop()();Z=!1,Q.clear(),D(t)}function qe(t){if(t.fragment!==null){t.update(),q(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ee)}}const z=new Set;let A;function ne(){A={r:0,c:[],p:A}}function re(){A.r||q(A.c),A=A.p}function p(t,e){t&&t.i&&(z.delete(t),t.i(e))}function w(t,e,r,n){if(t&&t.o){if(z.has(t))return;z.add(t),A.c.push(()=>{z.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function N(t){t&&t.c()}function L(t,e,r,n){const{fragment:o,on_mount:i,on_destroy:c,after_update:a}=t.$$;o&&o.m(e,r),n||ee(()=>{const s=i.map(ve).filter(Pe);c?c.push(...s):q(s),t.$$.on_mount=[]}),a.forEach(ee)}function C(t,e){const r=t.$$;r.fragment!==null&&(q(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Fe(t,e){t.$$.dirty[0]===-1&&(T.push(t),Ne(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function I(t,e,r,n,o,i,c,a=[-1]){const s=O;D(t);const l=t.$$={fragment:null,ctx:null,props:i,update:$,not_equal:o,bound:ce(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:ce(),dirty:a,skip_bound:!1,root:e.target||s.$$.root};c&&c(l.root);let f=!1;if(l.ctx=r?r(t,e.props||{},(g,v,...S)=>{const _=S.length?S[0]:v;return l.ctx&&o(l.ctx[g],l.ctx[g]=_)&&(!l.skip_bound&&l.bound[g]&&l.bound[g](_),f&&Fe(t,g)),v}):[],l.update(),f=!0,q(l.before_update),l.fragment=n?n(l.ctx):!1,e.target){if(e.hydrate){const g=Ce(e.target);l.fragment&&l.fragment.l(g),g.forEach(k)}else l.fragment&&l.fragment.c();e.intro&&p(t.$$.fragment),L(t,e.target,e.anchor,e.customElement),ye()}D(s)}class H{$destroy(){C(this,1),this.$destroy=$}$on(e,r){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const o=n.indexOf(r);o!==-1&&n.splice(o,1)}}$set(e){this.$$set&&!Le(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Te(t){let e,r,n,o;return{c(){e=y("button"),r=W(t[0]),d(e,"title",t[1]),d(e,"class","material-icons svelte-1i3k0cm")},m(i,c){E(i,e,c),h(e,r),n||(o=V(e,"click",t[3]),n=!0)},p(i,[c]){c&1&&$e(r,i[0]),c&2&&d(e,"title",i[1])},i:$,o:$,d(i){i&&k(e),n=!1,o()}}}function De(t,e,r){let{icon:n}=e,{title:o}=e;const i=we(),c=()=>i("click");return t.$$set=a=>{"icon"in a&&r(0,n=a.icon),"title"in a&&r(1,o=a.title)},[n,o,i,c]}class te extends H{constructor(e){super(),I(this,e,De,Te,U,{icon:0,title:1})}}function Oe(t){let e;return{c(){e=y("header"),e.innerHTML=`<h1 class="svelte-lctqfv">Factorio Pixel Art Generator</h1> 
  <span class="version svelte-lctqfv">v1.0.0</span> 
  <a title="Changelog" class="material-icons svelte-lctqfv" href="https://github.com/NicoKandut/factorio-solar-art/blob/main/CHANGELOG.md" target="_newtab">feed</a> 
  <a title="Github Repository" class="material-icons svelte-lctqfv" href="https://github.com/NicoKandut/factorio-pixel-art-generator" target="_newtab"><svg height="16" aria-hidden="true" viewBox="0 0 16 16" width="16" data-view-component="true" style="fill: currentcolor; minWidth: 16px;"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a> 
  <a title="Discord Server" class="material-icons svelte-lctqfv" href="https://discord.gg/jPf45KS54t" target="_newtab">discord</a> 
  <a title="Solar Art Generator" href="https://nicokandut.github.io/factorio-solar-art/" target="_newtab" class="svelte-lctqfv"><img src="./solar_panel.png" alt="Solar Art Generator" class="svelte-lctqfv"/></a>`,d(e,"class","svelte-lctqfv")},m(r,n){E(r,e,n)},p:$,i:$,o:$,d(r){r&&k(e)}}}class Ue extends H{constructor(e){super(),I(this,e,null,Oe,U,{})}}const Ie=t=>({}),de=t=>({}),He=t=>({}),_e=t=>({});function Be(t){let e,r,n,o,i,c,a,s,l,f;const g=t[2].actions,v=se(g,t,t[1],_e),S=t[2].content,_=se(S,t,t[1],de);return{c(){e=y("section"),r=y("div"),n=y("span"),o=W(t[0]),i=P(),c=y("div"),a=P(),v&&v.c(),s=P(),l=y("div"),_&&_.c(),d(c,"class","spacer svelte-1envtgn"),d(r,"class","title svelte-1envtgn"),d(l,"class","content svelte-1envtgn"),d(e,"class","svelte-1envtgn")},m(u,b){E(u,e,b),h(e,r),h(r,n),h(n,o),h(r,i),h(r,c),h(r,a),v&&v.m(r,null),h(e,s),h(e,l),_&&_.m(l,null),f=!0},p(u,[b]){(!f||b&1)&&$e(o,u[0]),v&&v.p&&(!f||b&2)&&ae(v,g,u,u[1],f?le(g,u[1],b,He):ue(u[1]),_e),_&&_.p&&(!f||b&2)&&ae(_,S,u,u[1],f?le(S,u[1],b,Ie):ue(u[1]),de)},i(u){f||(p(v,u),p(_,u),f=!0)},o(u){w(v,u),w(_,u),f=!1},d(u){u&&k(e),v&&v.d(u),_&&_.d(u)}}}function Me(t,e,r){let{$$slots:n={},$$scope:o}=e,{title:i}=e;return t.$$set=c=>{"title"in c&&r(0,i=c.title),"$$scope"in c&&r(1,o=c.$$scope)},[i,o,n]}class me extends H{constructor(e){super(),I(this,e,Me,Be,U,{title:0})}}function Re(t){let e,r,n,o,i,c,a,s;return{c(){e=y("div"),r=y("span"),r.textContent="upload",n=P(),o=y("span"),o.textContent="Click here to upload a picture or drag and drop a picture here",i=P(),c=y("input"),d(r,"class","material-icons svelte-147nu1e"),d(o,"class","hint svelte-147nu1e"),d(c,"type","file"),d(c,"accept","image/*"),d(c,"class","svelte-147nu1e"),d(e,"class","svelte-147nu1e")},m(l,f){E(l,e,f),h(e,r),h(e,n),h(e,o),h(e,i),h(e,c),t[2](c),a||(s=[V(c,"change",t[3]),V(e,"click",t[4])],a=!0)},p:$,i:$,o:$,d(l){l&&k(e),t[2](null),a=!1,q(s)}}}function Ge(t,e,r){const n=we();let o;function i(s){Y[s?"unshift":"push"](()=>{o=s,r(0,o)})}return[o,n,i,s=>{var f;const l=(f=s.target.files)==null?void 0:f[0];n("upload",l)},()=>o==null?void 0:o.click()]}class ze extends H{constructor(e){super(),I(this,e,Ge,Re,U,{})}}function pe(t){let e,r;return e=new te({props:{title:"Clear",icon:"clear"}}),e.$on("click",t[6]),{c(){N(e.$$.fragment)},m(n,o){L(e,n,o),r=!0},p:$,i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){w(e.$$.fragment,n),r=!1},d(n){C(e,n)}}}function Ke(t){let e,r,n=t[0]!==void 0&&pe(t);return{c(){n&&n.c(),e=X()},m(o,i){n&&n.m(o,i),E(o,e,i),r=!0},p(o,i){o[0]!==void 0?n?(n.p(o,i),i&1&&p(n,1)):(n=pe(o),n.c(),p(n,1),n.m(e.parentNode,e)):n&&(ne(),w(n,1,1,()=>{n=null}),re())},i(o){r||(p(n),r=!0)},o(o){w(n),r=!1},d(o){n&&n.d(o),o&&k(e)}}}function We(t){let e,r,n;return{c(){e=y("img"),K(e.src,r=URL.createObjectURL(t[0]))||d(e,"src",r),d(e,"alt",n=t[0].name),d(e,"class","svelte-uzukoj")},m(o,i){E(o,e,i)},p(o,i){i&1&&!K(e.src,r=URL.createObjectURL(o[0]))&&d(e,"src",r),i&1&&n!==(n=o[0].name)&&d(e,"alt",n)},i:$,o:$,d(o){o&&k(e)}}}function Xe(t){let e,r;return e=new ze({}),e.$on("upload",t[5]),{c(){N(e.$$.fragment)},m(n,o){L(e,n,o),r=!0},p:$,i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){w(e.$$.fragment,n),r=!1},d(n){C(e,n)}}}function Je(t){let e,r,n,o;const i=[Xe,We],c=[];function a(s,l){return s[0]===void 0?0:1}return e=a(t),r=c[e]=i[e](t),{c(){r.c(),n=X()},m(s,l){c[e].m(s,l),E(s,n,l),o=!0},p(s,l){let f=e;e=a(s),e===f?c[e].p(s,l):(ne(),w(c[f],1,1,()=>{c[f]=null}),re(),r=c[e],r?r.p(s,l):(r=c[e]=i[e](s),r.c()),p(r,1),r.m(n.parentNode,n))},i(s){o||(p(r),o=!0)},o(s){w(r),o=!1},d(s){c[e].d(s),s&&k(n)}}}function ge(t){let e,r,n,o;return e=new te({props:{title:"Copy blueprint to clipboard",icon:"content_copy"}}),e.$on("click",t[3]),n=new te({props:{title:"Download Blueprint",icon:"download"}}),n.$on("click",t[4]),{c(){N(e.$$.fragment),r=P(),N(n.$$.fragment)},m(i,c){L(e,i,c),E(i,r,c),L(n,i,c),o=!0},p:$,i(i){o||(p(e.$$.fragment,i),p(n.$$.fragment,i),o=!0)},o(i){w(e.$$.fragment,i),w(n.$$.fragment,i),o=!1},d(i){C(e,i),i&&k(r),C(n,i)}}}function Qe(t){let e,r,n=t[1]&&ge(t);return{c(){n&&n.c(),e=X()},m(o,i){n&&n.m(o,i),E(o,e,i),r=!0},p(o,i){o[1]?n?(n.p(o,i),i&2&&p(n,1)):(n=ge(o),n.c(),p(n,1),n.m(e.parentNode,e)):n&&(ne(),w(n,1,1,()=>{n=null}),re())},i(o){r||(p(n),r=!0)},o(o){w(n),r=!1},d(o){n&&n.d(o),o&&k(e)}}}function he(t){let e,r;return{c(){e=y("img"),K(e.src,r=t[1])||d(e,"src",r),d(e,"alt","Preview"),d(e,"class","svelte-uzukoj")},m(n,o){E(n,e,o)},p(n,o){o&2&&!K(e.src,r=n[1])&&d(e,"src",r)},d(n){n&&k(e)}}}function Ve(t){let e,r=t[1]&&he(t);return{c(){r&&r.c(),e=X()},m(n,o){r&&r.m(n,o),E(n,e,o)},p(n,o){n[1]?r?r.p(n,o):(r=he(n),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null)},d(n){r&&r.d(n),n&&k(e)}}}function Ye(t){let e,r,n,o,i,c,a;return r=new Ue({}),o=new me({props:{title:"Source",$$slots:{content:[Je],actions:[Ke]},$$scope:{ctx:t}}}),c=new me({props:{title:"Preview",$$slots:{content:[Ve],actions:[Qe]},$$scope:{ctx:t}}}),{c(){e=y("main"),N(r.$$.fragment),n=P(),N(o.$$.fragment),i=P(),N(c.$$.fragment),d(e,"class","svelte-uzukoj")},m(s,l){E(s,e,l),L(r,e,null),h(e,n),L(o,e,null),h(e,i),L(c,e,null),a=!0},p(s,[l]){const f={};l&2051&&(f.$$scope={dirty:l,ctx:s}),o.$set(f);const g={};l&2050&&(g.$$scope={dirty:l,ctx:s}),c.$set(g)},i(s){a||(p(r.$$.fragment,s),p(o.$$.fragment,s),p(c.$$.fragment,s),a=!0)},o(s){w(r.$$.fragment,s),w(o.$$.fragment,s),w(c.$$.fragment,s),a=!1},d(s){s&&k(e),C(r),C(o),C(c)}}}const j=1;function Ze(t,e,r){let n,o,i,c,a;async function s(){const b=await(await(await fetch("./out.js")).blob()).text();n=await Function('"use strict"; '+b.replace("var Module = ","return"))()(),a=n.cwrap("process","string",["number","number","number","number","number"])}s();async function l(_){performance.mark("start");let u,b;try{const m=await createImageBitmap(_),F=document.createElement("canvas");F.width=m.width,F.height=m.height;const B=F.getContext("2d");B.drawImage(m,0,0);const J=B.getImageData(0,0,m.width,m.height);u=n._create_buffer(m.width,m.height),b=n._create_buffer(m.width*j,m.height*j),n.HEAP8.set(J.data,u),performance.mark("proc-start"),console.log("[js] Processing image..."),c=a(u,b,m.width,m.height,j),performance.mark("proc-end");const x=document.createElement("canvas"),oe=x.getContext("2d");x.width=m.width*j,x.height=m.height*j;const ke=n.HEAPU8.subarray(b,b+x.width*x.height*4),ie=oe.createImageData(m.width*j,m.height*j);ie.data.set(ke),oe.putImageData(ie,0,0),r(1,i=x.toDataURL("image/png"))}catch(m){console.error("Processing failed",m),performance.mark("proc-end")}finally{n._destroy_buffer(u),n._destroy_buffer(b),performance.mark("end");const m=performance.measure("total time","start","end").duration.toFixed(0),F=performance.measure("preparation time","start","proc-start").duration.toFixed(0),B=performance.measure("processing time","proc-start","proc-end").duration.toFixed(0),J=performance.measure("processing time","proc-end","end").duration.toFixed(0),x=`[js] Done. Took ${m} ms total.`;console.group(x),console.info("Preparation",F,"ms"),console.info("Processing",B,"ms"),console.info("End",J,"ms"),console.groupEnd()}}async function f(){if(c!==void 0)try{await navigator.clipboard.writeText(c)}catch(_){console.error("Unexpected error while copying:",_)}}async function g(){if(c===void 0)return;const u=await(await window.showSaveFilePicker({types:[{description:"Text Files",accept:{"text/plain":[".txt"]}}],suggestedName:"generated blueprint"})).createWritable();await u.write(c),await u.close()}return[o,i,l,f,g,async _=>{r(0,o=_.detail),await l(o)},()=>{r(0,o=void 0),r(1,i=void 0)}]}class et extends H{constructor(e){super(),I(this,e,Ze,Ye,U,{})}}new et({target:document.getElementById("app")});
